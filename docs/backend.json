
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Auditgelap application.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "The user's unique identifier from the authentication provider."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "role": {
          "type": "string",
          "description": "Access tier: 'free', 'executioner', or 'war_room'.",
          "enum": ["free", "executioner", "war_room"]
        },
        "isPremium": {
          "type": "boolean",
          "description": "Indicates active premium status."
        },
        "stats": {
          "type": "object",
          "properties": {
            "totalAudits": { "type": "number" },
            "totalLossObserved": { "type": "number" },
            "completedCommands": { "type": "number" },
            "failedCommands": { "type": "number" }
          }
        },
        "subscription": {
          "type": "object",
          "properties": {
            "planId": { "type": "string" },
            "status": { "type": "string", "enum": ["active", "expired"] },
            "currentPeriodEnd": { "type": "number" },
            "midtransOrderId": { "type": "string" }
          }
        },
        "createdAt": {
          "type": "number",
          "description": "Timestamp of account creation."
        }
      },
      "required": ["uid", "email", "name", "role", "isPremium", "createdAt"]
    },
    "AuditLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditLog",
      "type": "object",
      "description": "A record of an AI-powered audit.",
      "properties": {
        "userId": { "type": "string" },
        "input": {
          "type": "object",
          "properties": {
            "situationDetails": { "type": "string" },
            "langPreference": { "type": "string" }
          },
          "required": ["situationDetails", "langPreference"]
        },
        "output": {
          "type": "object",
          "properties": {
            "diagnosis_title": { "type": "string" },
            "brutal_diagnosis": { "type": "string" },
            "opportunity_cost_idr": { "type": "number" },
            "growth_loss_percentage": { "type": "number" },
            "dark_analogy": { "type": "string" },
            "strategic_commands": { "type": "array", "items": { "type": "string" } }
          }
        },
        "type": {
          "type": "string",
          "enum": ["standard", "deep_audit"]
        },
        "timestamp": { "type": "number" }
      },
      "required": ["userId", "input", "output", "type", "timestamp"]
    },
    "ActiveCommand": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ActiveCommand",
      "type": "object",
      "description": "An actionable command assigned to a user.",
      "properties": {
        "userId": { "type": "string" },
        "auditId": { "type": "string" },
        "task": { "type": "string" },
        "deadline": { "type": "number" },
        "status": { "type": "string", "enum": ["pending", "completed", "failed"] },
        "isPremiumFeature": { "type": "boolean" }
      },
      "required": ["userId", "auditId", "task", "deadline", "status", "isPremiumFeature"]
    },
    "Waitlist": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Waitlist",
      "type": "object",
      "description": "Email waitlist for early access.",
      "properties": {
        "email": { "type": "string", "format": "email" },
        "timestamp": { "type": "number" }
      },
      "required": ["email", "timestamp"]
    }
  },
  "auth": {
    "providers": ["password", "anonymous"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/backend/entities/User" },
      "description": "Stores user profile."
    },
    "/users/{userId}/audit_logs/{auditId}": {
      "schema": { "$ref": "#/backend/entities/AuditLog" },
      "description": "User audit history."
    },
    "/users/{userId}/active_commands/{commandId}": {
      "schema": { "$ref": "#/backend/entities/ActiveCommand" },
      "description": "User active commands."
    },
    "/waitlist/{waitlistId}": {
      "schema": { "$ref": "#/backend/entities/Waitlist" },
      "description": "Public waitlist for early access."
    }
  }
}
